<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Garmin Fleet Management Controller: CStopListDlg.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>CStopListDlg.cpp</h1>  </div>
</div>
<div class="contents">
<a href="CStopListDlg_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">*</span>
<a name="l00003"></a>00003 <span class="comment">*   MODULE NAME:</span>
<a name="l00004"></a>00004 <span class="comment">*       CStopListDlg.cpp</span>
<a name="l00005"></a>00005 <span class="comment">*</span>
<a name="l00006"></a>00006 <span class="comment">*   Copyright 2008-2009 by Garmin Ltd. or its subsidiaries.</span>
<a name="l00007"></a>00007 <span class="comment">*---------------------------------------------------------------------</span>
<a name="l00008"></a>00008 <span class="comment">* $NoKeywords$</span>
<a name="l00009"></a>00009 <span class="comment">*********************************************************************/</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="stdafx_8h.html">stdafx.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="CFmiApplication_8h.html">CFmiApplication.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="CStopListDlg_8h.html">CStopListDlg.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="CStopNewDlg_8h.html">CStopNewDlg.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="Event_8h.html">Event.h</a>&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">using namespace </span>std;
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 IMPLEMENT_DYNAMIC( <a class="code" href="classCStopListDlg.html" title="Modeless dialog allowing the user to manage the A603 stops //! on the client device. //!">CStopListDlg</a>, CDialog )
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 BEGIN_MESSAGE_MAP( <a class="code" href="classCStopListDlg.html" title="Modeless dialog allowing the user to manage the A603 stops //! on the client device. //!">CStopListDlg</a>, CDialog )
<a name="l00021"></a>00021     ON_BN_CLICKED( <a class="code" href="resource_8h.html#adf78a2fe031553f18e06a737fec598e5">IDC_STOPLIST_BTN_NEW_STOP</a>, OnBnClickedNewStop )
<a name="l00022"></a>00022     ON_BN_CLICKED( IDOK, OnBnClickedOk )
<a name="l00023"></a>00023 <span class="preprocessor">#if( FMI_SUPPORT_A603 )</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>    ON_MESSAGE( <a class="code" href="CWndEventListener_8h.html#a2ad6fb6553f143eeaef1c4afed2ac7cf" title="Translation from an application event to the corresponding Windows //! message.">WM_EVENT</a>( <a class="code" href="EventId_8h.html#a4cf8d4a4d56e9f795518b6541ddeb5bfad624082898235c07dd1c2eb0a7a2646d">EVENT_FMI_STOP_STATUS_CHANGED</a> ), OnEventStopListChanged )
<a name="l00025"></a>00025     ON_MESSAGE( <a class="code" href="CWndEventListener_8h.html#a2ad6fb6553f143eeaef1c4afed2ac7cf" title="Translation from an application event to the corresponding Windows //! message.">WM_EVENT</a>( <a class="code" href="EventId_8h.html#a4cf8d4a4d56e9f795518b6541ddeb5bfa81ebb9e8b1daaa662900945beea16a68">EVENT_FMI_ETA_RECEIVED</a> ), OnEventEtaReceived )
<a name="l00026"></a>00026     ON_CBN_SELCHANGE( <a class="code" href="resource_8h.html#a84297568caf1307757624296dc8ad1de">IDC_STOPLIST_CBO_UPDATE_STOP</a>, OnCbnSelChangeUpdateOption )
<a name="l00027"></a>00027     ON_EN_CHANGE( <a class="code" href="resource_8h.html#a06e92b5a8b596244cc37f03150bca8b0">IDC_STOPLIST_EDIT_MOVETO</a>, OnEnChangeMoveTo )
<a name="l00028"></a>00028     ON_BN_CLICKED( <a class="code" href="resource_8h.html#aed2fa050c0251d4d484a315c1996c6df">IDC_STOPLIST_BTN_SEND</a>, OnBnClickedSend )
<a name="l00029"></a>00029 <span class="preprocessor">#endif</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#if( FMI_SUPPORT_A604 )</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>    ON_BN_CLICKED( <a class="code" href="resource_8h.html#ae2c61d32f9f1cbcb9052cd6b1971f31e">IDC_STOPLIST_BTN_SORT</a>, OnBnClickedSort )
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>END_MESSAGE_MAP()
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00039"></a>00039 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00040"></a>00040 CStopListDlg::CStopListDlg
<a name="l00041"></a><a class="code" href="classCStopListDlg.html#a6b9735e3ae146df6cf735d6734d2c38e">00041</a>     (
<a name="l00042"></a>00042     CWnd                * aParent,
<a name="l00043"></a>00043     <a class="code" href="classFmiApplicationLayer.html" title="Serial communication controller for Garmin and FMI packets //!">FmiApplicationLayer</a> &amp; aCom )
<a name="l00044"></a>00044     : CDialog( <a class="code" href="resource_8h.html#a8b4e8a74dd05d234c1fae067f65525cc">IDD_STOP_LIST</a>, aParent )
<a name="l00045"></a>00045     , mCom( aCom )
<a name="l00046"></a>00046 <span class="preprocessor">#if( FMI_SUPPORT_A603 )</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>    , mSelectedStopIndex( 0 )
<a name="l00048"></a>00048     , mSelectedStopStatus( _T(<span class="stringliteral">&quot;&quot;</span>) )
<a name="l00049"></a>00049     , mSelectedUpdateIndex( 0 )
<a name="l00050"></a>00050     , mMoveTo( _T(<span class="stringliteral">&quot;&quot;</span>) )
<a name="l00051"></a>00051     , mEta( _T(<span class="stringliteral">&quot;&quot;</span>) )
<a name="l00052"></a>00052 <span class="preprocessor">#endif</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>{
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00058"></a>00058 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00059"></a><a class="code" href="classCStopListDlg.html#a1d553df5aaec3816c75c03efe023e728">00059</a> <a class="code" href="classCStopListDlg.html#a1d553df5aaec3816c75c03efe023e728" title="Destructor.">CStopListDlg::~CStopListDlg</a>()
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00066"></a>00066 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00067"></a>00067 <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#ad448106e08f1fe3d1c3d8f62700e8c3c" title="Perform dialog data exchange and validation //!">CStopListDlg::DoDataExchange</a>
<a name="l00068"></a><a class="code" href="classCStopListDlg.html#ad448106e08f1fe3d1c3d8f62700e8c3c">00068</a>     (
<a name="l00069"></a>00069     CDataExchange * aDataExchange
<a name="l00070"></a>00070     )
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072     CDialog::DoDataExchange( aDataExchange );
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="preprocessor">#if( FMI_SUPPORT_A603 )</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>    DDX_LBIndex( aDataExchange, <a class="code" href="resource_8h.html#a190c50ff507dcf5bfffd0f06a91f556a">IDC_STOPLIST_LST_SELECT_STOP</a>, mSelectedStopIndex );
<a name="l00076"></a>00076     DDX_Control( aDataExchange, <a class="code" href="resource_8h.html#a190c50ff507dcf5bfffd0f06a91f556a">IDC_STOPLIST_LST_SELECT_STOP</a>, mStopListBox );
<a name="l00077"></a>00077     DDX_Text( aDataExchange, <a class="code" href="resource_8h.html#a59d66e63a2052e8ac94a045406e1a974">IDC_STOPLIST_TXT_STATUS</a>, mSelectedStopStatus );
<a name="l00078"></a>00078     DDX_CBIndex( aDataExchange, IDC_STOPLIST_CBO_UPDATE_STOP, mSelectedUpdateIndex );
<a name="l00079"></a>00079     DDX_Text( aDataExchange, IDC_STOPLIST_EDIT_MOVETO, mMoveTo );
<a name="l00080"></a>00080     DDX_Text( aDataExchange, <a class="code" href="resource_8h.html#a425be0147dc2f795ef0c6df81de3ddca">IDC_STOPLIST_TXT_ETA</a>, mEta );
<a name="l00081"></a>00081 <span class="preprocessor">#endif</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span>}
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00090"></a>00090 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00091"></a><a class="code" href="classCStopListDlg.html#a7ae2961f9db562ef481b6baf5b4eec3b">00091</a> BOOL <a class="code" href="classCStopListDlg.html#a7ae2961f9db562ef481b6baf5b4eec3b" title="Initialize the dialog //!">CStopListDlg::OnInitDialog</a>()
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093     <a class="code" href="classCStopListDlg.html#a7ae2961f9db562ef481b6baf5b4eec3b" title="Initialize the dialog //!">CDialog::OnInitDialog</a>();
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     SetWindowPos( NULL, 700, 35, 0, 0, SWP_NOSIZE | SWP_NOZORDER );
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="preprocessor">#if FMI_SUPPORT_A603</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>    <a class="code" href="classCStopListDlg.html#a21ca90983e558463ed7c3aa7c5d79362" title="Handler for the Stop List Changed event //!">OnEventStopListChanged</a>( 0, NULL );
<a name="l00099"></a>00099 <span class="preprocessor">#endif</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>
<a name="l00101"></a>00101 <span class="preprocessor">#if( !FMI_SUPPORT_A603 )</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>    GetDlgItem( <a class="code" href="resource_8h.html#a6b0f6893febe7b44e43e3850b700f58a">IDC_STOPLIST_LBL_ETA</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00103"></a>00103     GetDlgItem( <a class="code" href="resource_8h.html#a6ea0eb9dec485f75e82d3e441cb8ab4f">IDC_STOPLIST_LBL_SELECT_STOP</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00104"></a>00104     GetDlgItem( <a class="code" href="resource_8h.html#ae3cbd40143f645669670f39110356180">IDC_STOPLIST_LBL_STATUS</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00105"></a>00105     GetDlgItem( <a class="code" href="resource_8h.html#aa11a20079428941c365efd82700a4cae">IDC_STOPLIST_LBL_MOVETO</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00106"></a>00106     GetDlgItem( <a class="code" href="resource_8h.html#a190c50ff507dcf5bfffd0f06a91f556a">IDC_STOPLIST_LST_SELECT_STOP</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00107"></a>00107     GetDlgItem( IDC_STOPLIST_BTN_SEND )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00108"></a>00108     GetDlgItem( <a class="code" href="resource_8h.html#af75b19b454e9a860ac9d267f16606190">IDC_STOPLIST_GRP_UPDATE_STOP</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00109"></a>00109     GetDlgItem( <a class="code" href="resource_8h.html#a425be0147dc2f795ef0c6df81de3ddca">IDC_STOPLIST_TXT_ETA</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00110"></a>00110     GetDlgItem( <a class="code" href="resource_8h.html#a59d66e63a2052e8ac94a045406e1a974">IDC_STOPLIST_TXT_STATUS</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00111"></a>00111     GetDlgItem( IDC_STOPLIST_EDIT_MOVETO )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00112"></a>00112     GetDlgItem( IDC_STOPLIST_CBO_UPDATE_STOP )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00113"></a>00113 <span class="preprocessor">#endif</span>
<a name="l00114"></a>00114 <span class="preprocessor"></span>
<a name="l00115"></a>00115 <span class="preprocessor">#if( !FMI_SUPPORT_A604 )</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>    GetDlgItem( <a class="code" href="resource_8h.html#ae2c61d32f9f1cbcb9052cd6b1971f31e">IDC_STOPLIST_BTN_SORT</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00117"></a>00117 <span class="preprocessor">#endif</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>
<a name="l00119"></a>00119     <span class="keywordflow">return</span> TRUE;
<a name="l00120"></a>00120 }    <span class="comment">/* OnInitDialog() */</span>
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="preprocessor">#if( FMI_SUPPORT_A603 )</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00128"></a>00128 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00129"></a><a class="code" href="classCStopListDlg.html#a21ca90983e558463ed7c3aa7c5d79362">00129</a> afx_msg LRESULT <a class="code" href="classCStopListDlg.html#a21ca90983e558463ed7c3aa7c5d79362" title="Handler for the Stop List Changed event //!">CStopListDlg::OnEventStopListChanged</a>( WPARAM, LPARAM )
<a name="l00130"></a>00130 {
<a name="l00131"></a>00131     <span class="keywordtype">int</span> i = 0;
<a name="l00132"></a>00132     <span class="keywordflow">if</span>( !<a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>.empty() )
<a name="l00133"></a>00133         {
<a name="l00134"></a>00134         <span class="comment">//must keep track of where the list was scrolled to</span>
<a name="l00135"></a>00135         <span class="comment">//since we reset content we must reinitialize these</span>
<a name="l00136"></a>00136         <span class="keywordtype">int</span> selectedIndex = <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.GetCurSel();
<a name="l00137"></a>00137         <span class="keywordtype">int</span> topIndex = <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.GetTopIndex();
<a name="l00138"></a>00138         <span class="keywordflow">if</span>( selectedIndex == -1 )
<a name="l00139"></a>00139             selectedIndex = 0;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <span class="comment">//reset content and then add back current stops</span>
<a name="l00142"></a>00142         <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.ResetContent();
<a name="l00143"></a>00143         <a class="code" href="garmin__types_8h.html#a9560e25c315bae45d1ed4e2ce49ce55a" title="32-bit unsigned integer">uint32</a> stopId = <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>[i];
<a name="l00144"></a>00144         <span class="keywordflow">while</span>( stopId != <a class="code" href="fmi_8h.html#aef1fbe2ffcd5b92daf6b46fe2fc2b95f" title="Placeholder for an invalid 32-bit value.">INVALID32</a> )
<a name="l00145"></a>00145             {
<a name="l00146"></a>00146             <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.AddString( <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a16cff1b5e13bf0ef80c4f36cc7153289" title="Map of unique ID to stop details for all A603 stops on the client //!">mA603Stops</a>.<a class="code" href="classFileBackedMap.html#a7bb24d2149d2b67555476b98925d62ea" title="Get the item by key //!">get</a>( stopId ).<a class="code" href="classClientListItem.html#a4e0959fcf7b54125ecee08652c187410" title="Get the current name of this item //!">getCurrentName</a>() );
<a name="l00147"></a>00147             i++;
<a name="l00148"></a>00148             stopId = <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>[i];
<a name="l00149"></a>00149             }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151         <span class="comment">//update data</span>
<a name="l00152"></a>00152         UpdateData( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00153"></a>00153         <span class="comment">//display status</span>
<a name="l00154"></a>00154         <span class="keywordflow">if</span>( <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a16cff1b5e13bf0ef80c4f36cc7153289" title="Map of unique ID to stop details for all A603 stops on the client //!">mA603Stops</a>.<a class="code" href="classFileBackedMap.html#a8184c22c8addd8113b5d5e02f6737146" title="Check whether the specified key is in the map //.">contains</a>( <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>[selectedIndex] ) )
<a name="l00155"></a>00155         {
<a name="l00156"></a>00156             <a class="code" href="classStopListItem.html" title="Data structure to hold details of an A603 //! stop that the server needs to keep. //!...">StopListItem</a>&amp; item = <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a16cff1b5e13bf0ef80c4f36cc7153289" title="Map of unique ID to stop details for all A603 stops on the client //!">mA603Stops</a>.<a class="code" href="classFileBackedMap.html#a7bb24d2149d2b67555476b98925d62ea" title="Get the item by key //!">get</a>( <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>[selectedIndex] );
<a name="l00157"></a>00157 
<a name="l00158"></a>00158             <span class="keywordflow">switch</span>( item.<a class="code" href="classStopListItem.html#a20d951d5521322f6a0b1673e364683b8" title="Get the stop status //!">getStopStatus</a>() )
<a name="l00159"></a>00159             {
<a name="l00160"></a>00160                 <span class="keywordflow">case</span> <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fa1682b75d979b541839ba8b8836eeff32">STOP_STATUS_ACTIVE</a>:
<a name="l00161"></a>00161                     {
<a name="l00162"></a>00162                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot; Active&quot;</span>) );
<a name="l00163"></a>00163                     <a class="code" href="classCStopListDlg.html#a7a38afc603f0f940189f0a693fa1c7ce" title="Handle an ETA Received event from FmiApplicationLayer //!">OnEventEtaReceived</a>( 0, NULL );
<a name="l00164"></a>00164                     }
<a name="l00165"></a>00165                     <span class="keywordflow">break</span>;
<a name="l00166"></a>00166                 <span class="keywordflow">case</span> <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fae186a65cdf9955164539083ba198f1cb">STOP_STATUS_DONE</a>:
<a name="l00167"></a>00167                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot; Done&quot;</span>) );
<a name="l00168"></a>00168                     <span class="keywordflow">break</span>;
<a name="l00169"></a>00169                 <span class="keywordflow">case</span> <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fa9794fd29efcd11825c93f8b2779a50de">STOP_STATUS_UNREAD</a>:
<a name="l00170"></a>00170                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot; Unread Inactive&quot;</span>) );
<a name="l00171"></a>00171                     <span class="keywordflow">break</span>;
<a name="l00172"></a>00172                 <span class="keywordflow">case</span> <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fa99256959f72d3c03d0e1d2cc4e0dae48">STOP_STATUS_READ</a>:
<a name="l00173"></a>00173                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot; Read Inactive&quot;</span>) );
<a name="l00174"></a>00174                     <span class="keywordflow">break</span>;
<a name="l00175"></a>00175                 <span class="keywordflow">case</span> <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3faca6a2ee0fbedaca27ecd7eac5d72763f">STOP_STATUS_DELETED</a>:
<a name="l00176"></a>00176                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot; Deleted&quot;</span>) );
<a name="l00177"></a>00177                     <span class="keywordflow">break</span>;
<a name="l00178"></a>00178                 <span class="keywordflow">default</span>:
<a name="l00179"></a>00179                     <a class="code" href="classCStopListDlg.html#a779f69931ef3e248bac5a657e3cd8745" title="Text description of the selected stop&amp;#39;s status.">mSelectedStopStatus</a>.Format( _T(<span class="stringliteral">&quot;&quot;</span>) );
<a name="l00180"></a>00180                     <span class="keywordflow">break</span>;
<a name="l00181"></a>00181             } <span class="comment">// end of switch</span>
<a name="l00182"></a>00182 
<a name="l00183"></a>00183             <span class="keywordflow">if</span>( item.<a class="code" href="classStopListItem.html#a20d951d5521322f6a0b1673e364683b8" title="Get the stop status //!">getStopStatus</a>() == STOP_STATUS_ACTIVE )
<a name="l00184"></a>00184                 {
<a name="l00185"></a>00185                 <span class="comment">//since the stop is active the ETA should be displayed</span>
<a name="l00186"></a>00186                 GetDlgItem( <a class="code" href="resource_8h.html#a6b0f6893febe7b44e43e3850b700f58a">IDC_STOPLIST_LBL_ETA</a> )-&gt;ShowWindow( SW_SHOW );
<a name="l00187"></a>00187                 GetDlgItem( <a class="code" href="resource_8h.html#a425be0147dc2f795ef0c6df81de3ddca">IDC_STOPLIST_TXT_ETA</a> )-&gt;ShowWindow( SW_SHOW );
<a name="l00188"></a>00188                 }
<a name="l00189"></a>00189             <span class="keywordflow">else</span>
<a name="l00190"></a>00190                 {
<a name="l00191"></a>00191                 <span class="comment">//all the rest aren&#39;t active...hide ETA stuff</span>
<a name="l00192"></a>00192                 GetDlgItem( <a class="code" href="resource_8h.html#a6b0f6893febe7b44e43e3850b700f58a">IDC_STOPLIST_LBL_ETA</a> )-&gt;ShowWindow( SW_HIDE );
<a name="l00193"></a>00193                 GetDlgItem( <a class="code" href="resource_8h.html#a425be0147dc2f795ef0c6df81de3ddca">IDC_STOPLIST_TXT_ETA</a> )-&gt;ShowWindow( SW_HIDE );
<a name="l00194"></a>00194                 }
<a name="l00195"></a>00195         }
<a name="l00196"></a>00196         UpdateData( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00197"></a>00197         <span class="comment">//reset scroll and selection</span>
<a name="l00198"></a>00198         <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.SetCurSel( selectedIndex );
<a name="l00199"></a>00199         <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.SetTopIndex( topIndex );
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     <span class="keywordflow">else</span>
<a name="l00202"></a>00202         <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.ResetContent();
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <span class="keywordflow">return</span> 0;
<a name="l00205"></a>00205 }    <span class="comment">/* OnEventStopListChanged() */</span>
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00212"></a>00212 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00213"></a><a class="code" href="classCStopListDlg.html#a69349e11c939ebfbc2a1d803ead0e631">00213</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a69349e11c939ebfbc2a1d803ead0e631" title="Selection Change handler for the Update Stop combo box //!">CStopListDlg::OnCbnSelChangeUpdateOption</a>()
<a name="l00214"></a>00214 {
<a name="l00215"></a>00215     UpdateData( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00216"></a>00216     <span class="keywordflow">if</span>( <a class="code" href="classCStopListDlg.html#a303c2b783455e1224c7edf3a9af11eb5" title="Index of the selected item in the Update Stop combo box //!">mSelectedUpdateIndex</a> == <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fa3664748b5372bd0d3f5d46cf2b95859d">REQUEST_MOVE_STOP</a> )
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218         GetDlgItem( <a class="code" href="resource_8h.html#aa11a20079428941c365efd82700a4cae">IDC_STOPLIST_LBL_MOVETO</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00219"></a>00219         GetDlgItem( IDC_STOPLIST_EDIT_MOVETO )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00220"></a>00220         <a class="code" href="classCStopListDlg.html#a4c0133be894d15b47edf136d7b1f1da8" title="Edit handler for the Move To text box //!">OnEnChangeMoveTo</a>();
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222     <span class="keywordflow">else</span>
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224         GetDlgItem( IDC_STOPLIST_BTN_SEND )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00225"></a>00225         <a class="code" href="classCStopListDlg.html#a7a569d2b2b6f1bf5fbea52f21f856d23" title="Text in the &amp;quot;Move To&amp;quot; edit box.">mMoveTo</a>.Format( _T(<span class="stringliteral">&quot;&quot;</span>) );
<a name="l00226"></a>00226         GetDlgItem( <a class="code" href="resource_8h.html#aa11a20079428941c365efd82700a4cae">IDC_STOPLIST_LBL_MOVETO</a> )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00227"></a>00227         GetDlgItem( IDC_STOPLIST_EDIT_MOVETO )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00228"></a>00228         UpdateData( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230 }    <span class="comment">/* OnCbnSelChangeUpdateOption() */</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00237"></a>00237 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00238"></a><a class="code" href="classCStopListDlg.html#a4c0133be894d15b47edf136d7b1f1da8">00238</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a4c0133be894d15b47edf136d7b1f1da8" title="Edit handler for the Move To text box //!">CStopListDlg::OnEnChangeMoveTo</a>()
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240 <span class="preprocessor">#if !SKIP_VALIDATION</span>
<a name="l00241"></a>00241 <span class="preprocessor"></span>    UpdateData( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00242"></a>00242     <span class="keywordflow">if</span>( <a class="code" href="classCStopListDlg.html#a7a569d2b2b6f1bf5fbea52f21f856d23" title="Text in the &amp;quot;Move To&amp;quot; edit box.">mMoveTo</a> != <span class="stringliteral">&quot;&quot;</span>                              &amp;&amp;
<a name="l00243"></a>00243         _ttoi( <a class="code" href="classCStopListDlg.html#a7a569d2b2b6f1bf5fbea52f21f856d23" title="Text in the &amp;quot;Move To&amp;quot; edit box.">mMoveTo</a> ) &lt; <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.GetCount() &amp;&amp;
<a name="l00244"></a>00244         _ttoi( <a class="code" href="classCStopListDlg.html#a7a569d2b2b6f1bf5fbea52f21f856d23" title="Text in the &amp;quot;Move To&amp;quot; edit box.">mMoveTo</a> ) &gt;= 0 )
<a name="l00245"></a>00245     {
<a name="l00246"></a>00246         GetDlgItem( IDC_STOPLIST_BTN_SEND )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248     <span class="keywordflow">else</span>
<a name="l00249"></a>00249     {
<a name="l00250"></a>00250         GetDlgItem( IDC_STOPLIST_BTN_SEND )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252 <span class="preprocessor">#else</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span>    GetDlgItem( IDC_STOPLIST_BTN_SEND )-&gt;EnableWindow( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00254"></a>00254 <span class="preprocessor">#endif</span>
<a name="l00255"></a>00255 <span class="preprocessor"></span>}    <span class="comment">/* OnEnChangeMoveTo() */</span>
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00262"></a>00262 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00263"></a><a class="code" href="classCStopListDlg.html#a9c593054aed1bf1cbd57c820e5c953a9">00263</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a9c593054aed1bf1cbd57c820e5c953a9" title="Click handler for the Send button //!">CStopListDlg::OnBnClickedSend</a>()
<a name="l00264"></a>00264 {
<a name="l00265"></a>00265     UpdateData( <a class="code" href="garmin__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a> );
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <span class="keywordflow">if</span>( <a class="code" href="classCStopListDlg.html#ae1deeefad1f14e7192a3f6bf847ebe44" title="The list box control containing the A603 stops.">mStopListBox</a>.GetCurSel() != -1 )
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269         <span class="comment">//If the update is not a move, just send the update. Even if</span>
<a name="l00270"></a>00270         <span class="comment">//the stop status protocol is throttled, having an out of date</span>
<a name="l00271"></a>00271         <span class="comment">//status is not a major issue at this point since it can be</span>
<a name="l00272"></a>00272         <span class="comment">//requested by the user.</span>
<a name="l00273"></a>00273         <span class="keywordflow">if</span>( <a class="code" href="classCStopListDlg.html#a303c2b783455e1224c7edf3a9af11eb5" title="Index of the selected item in the Update Stop combo box //!">mSelectedUpdateIndex</a> != <a class="code" href="fmi_8h.html#a6d34b6f06b323cebd607b6adfe874b3fa3664748b5372bd0d3f5d46cf2b95859d">REQUEST_MOVE_STOP</a> )
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275             <a class="code" href="garmin__types_8h.html#a9560e25c315bae45d1ed4e2ce49ce55a" title="32-bit unsigned integer">uint32</a> selectedStopId = <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a4ab006701573a13b5ef16f4b9bd190bc" title="Vector relating the stop list to unique_ids //!">mStopIndexInList</a>[<a class="code" href="classCStopListDlg.html#a269f53dd3228a6b61b3dadab3b968a93" title="Index of the selected stop in the stop list.">mSelectedStopIndex</a>]; <span class="comment">//in case it gets deleted</span>
<a name="l00276"></a>00276             <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a5f229176e433355455da37071c04dfe4" title="Initiate the Stop Status protocol to update an A603 stop. //!">sendStopStatusRequest</a>( selectedStopId, (<a class="code" href="fmi_8h.html#a1f68f8d9bdcc570e558238bfdbc95f7e" title="Enumeration for Stop Status protocol. //!">stop_status_status_type</a>) <a class="code" href="classCStopListDlg.html#a303c2b783455e1224c7edf3a9af11eb5" title="Index of the selected item in the Update Stop combo box //!">mSelectedUpdateIndex</a>, <a class="code" href="fmi_8h.html#ab552ee94ee2021a15d768de7a89590f9" title="Placeholder for an invalid 16-bit value.">INVALID16</a> );
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         <span class="keywordflow">else</span>
<a name="l00279"></a>00279         {
<a name="l00280"></a>00280             <a class="code" href="garmin__types_8h.html#a2e00abb078d312d1d8c4fbcd6be343d8" title="16-bit unsigned integer">uint16</a> moveTo = (uint16)_ttoi( <a class="code" href="classCStopListDlg.html#a7a569d2b2b6f1bf5fbea52f21f856d23" title="Text in the &amp;quot;Move To&amp;quot; edit box.">mMoveTo</a> );
<a name="l00281"></a>00281             <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#acbecd2fabd4b7bb567ba8c1fd09982e6" title="Send a stop move request //!">sendStopMoveRequest</a>( moveTo, (<a class="code" href="garmin__types_8h.html#a2e00abb078d312d1d8c4fbcd6be343d8" title="16-bit unsigned integer">uint16</a>)<a class="code" href="classCStopListDlg.html#a269f53dd3228a6b61b3dadab3b968a93" title="Index of the selected stop in the stop list.">mSelectedStopIndex</a> );
<a name="l00282"></a>00282         }
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284 }    <span class="comment">/* OnBnClickedSend() */</span>
<a name="l00285"></a>00285 <span class="preprocessor">#endif</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span>
<a name="l00287"></a>00287 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00290"></a>00290 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00291"></a><a class="code" href="classCStopListDlg.html#a1f47c979fae53cdf3049ddcc762f226c">00291</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a1f47c979fae53cdf3049ddcc762f226c" title="Click handler for the New Stop button //!">CStopListDlg::OnBnClickedNewStop</a>()
<a name="l00292"></a>00292 {
<a name="l00293"></a>00293     <a class="code" href="classCStopNewDlg.html" title="Modal dialog allowing the user to send a new stop to the //! client.">CStopNewDlg</a> dlg( <span class="keyword">this</span>, <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a> );
<a name="l00294"></a>00294     dlg.DoModal();
<a name="l00295"></a>00295 }    <span class="comment">/* OnBnClickedNewStop */</span>
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="preprocessor">#if( FMI_SUPPORT_A604 )</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00302"></a>00302 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00303"></a><a class="code" href="classCStopListDlg.html#a07fa5212317c2b54f4f37c50e42250d3">00303</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a07fa5212317c2b54f4f37c50e42250d3" title="Click handler for the Sort button //!">CStopListDlg::OnBnClickedSort</a>()
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305     <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a7fd3f1dec42219ef2982add9e8840220" title="Sends a sort stop list request to the client. //!">sendStopSortRequest</a>();
<a name="l00306"></a>00306 }    <span class="comment">/* OnBnClickedSort */</span>
<a name="l00307"></a>00307 <span class="preprocessor">#endif</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>
<a name="l00309"></a>00309 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00312"></a>00312 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00313"></a><a class="code" href="classCStopListDlg.html#a0bd0a54d34f7b848320433398b464ba9">00313</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a0bd0a54d34f7b848320433398b464ba9" title="Click handler for the OK button //!">CStopListDlg::OnBnClickedOk</a>()
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315     DestroyWindow();
<a name="l00316"></a>00316 }    <span class="comment">/* OnBnClickedOk */</span>
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00321"></a>00321 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00322"></a><a class="code" href="classCStopListDlg.html#a37e259263ab9d310291a60b455925370">00322</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a37e259263ab9d310291a60b455925370" title="Handler for the Cancel action //!">CStopListDlg::OnCancel</a>()
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324     DestroyWindow();
<a name="l00325"></a>00325 }    <span class="comment">/* OnCancel() */</span>
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 <span class="comment">//----------------------------------------------------------------------</span>
<a name="l00330"></a>00330 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00331"></a><a class="code" href="classCStopListDlg.html#a4830d8d3be5a6494b626ced0cd42e1d7">00331</a> <span class="keywordtype">void</span> <a class="code" href="classCStopListDlg.html#a4830d8d3be5a6494b626ced0cd42e1d7" title="Perform final cleanup. //!">CStopListDlg::PostNcDestroy</a>()
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333     <a class="code" href="classCStopListDlg.html#a4830d8d3be5a6494b626ced0cd42e1d7" title="Perform final cleanup. //!">CDialog::PostNcDestroy</a>();
<a name="l00334"></a>00334     <a class="code" href="classEvent.html#a3671f7a77ec1bbdb6c6e0681431c5816" title="Posts a message to all windows that have registered to //! get events //!">Event::post</a>( <a class="code" href="EventId_8h.html#a4cf8d4a4d56e9f795518b6541ddeb5bfafcee7bd5cdb07deb63c01f4979fa3f57">EVENT_STOP_LIST_DLG_CLOSED</a> );
<a name="l00335"></a>00335 }    <span class="comment">/* PostNcDestroy() */</span>
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="preprocessor">#if FMI_SUPPORT_A603</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00343"></a>00343 <span class="comment"></span><span class="comment">//----------------------------------------------------------------------</span>
<a name="l00344"></a><a class="code" href="classCStopListDlg.html#a7a38afc603f0f940189f0a693fa1c7ce">00344</a> afx_msg LRESULT <a class="code" href="classCStopListDlg.html#a7a38afc603f0f940189f0a693fa1c7ce" title="Handle an ETA Received event from FmiApplicationLayer //!">CStopListDlg::OnEventEtaReceived</a>( WPARAM, LPARAM )
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346     TCHAR etaTime[13];
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     MultiByteToWideChar( <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#aa8bda2692621f9603e6a2b927a944e56" title="Code page used for encoding of text fields when communicating //! with the client.">mClientCodepage</a>, 0, <a class="code" href="classCStopListDlg.html#aff3209f4c12a9303a9bd8f8bc7544ca8" title="Reference to the FMI communication controller.">mCom</a>.<a class="code" href="classFmiApplicationLayer.html#a5bf59bf77a75f8bfefaefd1372a12353" title="String containing the ETA time from the client, or &amp;quot;invalid&amp;quot; //!">mEtaTime</a>, -1, etaTime, 13 );
<a name="l00349"></a>00349     etaTime[12] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00350"></a>00350     <a class="code" href="classCStopListDlg.html#a77de93573ff779871c67843faa86aa5e" title="Text in the ETA edit box.">mEta</a>.Format( _T(<span class="stringliteral">&quot; %s&quot;</span>), etaTime );
<a name="l00351"></a>00351     UpdateData( <a class="code" href="garmin__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> );
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="keywordflow">return</span> 0;
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu May 5 2011 15:43:38 for Garmin Fleet Management Controller by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
